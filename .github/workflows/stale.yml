name: 'Close stale issues and PRs'

on:
  schedule:
    # Run daily at 1:30 AM UTC
    - cron: '30 1 * * *'
  workflow_dispatch: # Allow manual triggering

permissions:
  issues: write
  pull-requests: write

jobs:
  stale:
    name: 'Mark and close stale issues and PRs'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/stale@v10
        with:
          # Stale configuration
          days-before-stale: 90
          days-before-close: 60

          # Labels
          stale-issue-label: 'stale'
          stale-pr-label: 'stale'
          exempt-issue-labels: 'help-wanted,good-first-issue,pinned'
          exempt-pr-labels: 'help-wanted,good-first-issue,pinned'

          # Exemptions
          exempt-all-issue-assignees: true
          exempt-all-pr-assignees: true
          exempt-all-issue-milestones: true
          exempt-all-pr-milestones: true

          # Issue messages
          stale-issue-message: |
            Hello ðŸ‘‹ Looks like there was no activity on this issue for the last 90 days.
            **Do you mind updating us on the status?** Is this still reproducible or needed? If yes, just comment on this issue or push a commit. Thanks! ðŸ¤—
            If there will be no activity for 60 days, this issue will be closed (we can always reopen an issue if we need!).

          close-issue-message: |
            Closing for now as there was no activity for the last 60 days after being marked as stale, let us know if you need this to be reopened! ðŸ¤—

          # PR messages
          stale-pr-message: |
            Hello ðŸ‘‹ Looks like there was no activity on this amazing PR for the last 90 days.
            **Do you mind updating us on the status?** Is there anything we can help with? If you plan to still work on it, just comment on this PR or push a commit. Thanks! ðŸ¤—
            If there will be no activity for 60 days, this PR will be closed (we can always reopen a PR if you get back to this!).

          close-pr-message: |
            Closing for now as there was no activity for the last 60 days after being marked as stale, let us know if you need this to be reopened! ðŸ¤—

          # Operations and behavior
          operations-per-run: 100
          ascending: true
          remove-stale-when-updated: true
